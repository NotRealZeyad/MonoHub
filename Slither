-- LocalScript in StarterPlayerScripts

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- Function to create the snake limbs
local function createSnakeLimbs()
    local limbNames = {"LeftArm", "RightArm", "LeftLeg", "RightLeg"}
    for _, partName in ipairs(limbNames) do
        local limb = character:FindFirstChild(partName)
        if limb then
            -- Create a new part for the snake limb
            local snakeLimb = Instance.new("Part")
            snakeLimb.Size = Vector3.new(1, 1, 3)
            snakeLimb.Anchored = false
            snakeLimb.CanCollide = false
            snakeLimb.BrickColor = BrickColor.new("Medium stone grey")
            snakeLimb.Material = Enum.Material.SmoothPlastic
            snakeLimb.Name = partName .. "_Snake"
            snakeLimb.Parent = character
            
            -- Weld the snake limb to the original limb
            local weld = Instance.new("Weld")
            weld.Part0 = limb
            weld.Part1 = snakeLimb
            weld.C0 = CFrame.new(0, 0, 0)
            weld.Parent = limb
        end
    end
end

-- Function to enable slither movement
local function enableSlitherMovement()
    humanoid.WalkSpeed = 10
    humanoid.JumpPower = 0

    local bodyGyro = Instance.new("BodyGyro")
    bodyGyro.Parent = rootPart
    bodyGyro.MaxTorque = Vector3.new(0, math.huge, 0)

    game:GetService("RunService").RenderStepped:Connect(function()
        if character and character:FindFirstChild("HumanoidRootPart") then
            bodyGyro.CFrame = CFrame.new(rootPart.Position, rootPart.Position + rootPart.CFrame.LookVector)
        end
    end)

    humanoid.Running:Connect(function(speed)
        if speed > 0 then
            humanoid:Move(Vector3.new(0, 0, 1), true)
        end
    end)
end

-- Start the transformation
createSnakeLimbs()
enableSlitherMovement()
